<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        x:Class="ScimitarBattery.SettingsWindow"
        Title="Scimitar Battery Monitor"
        Width="520" Height="560" MinWidth="520" MinHeight="560"
        SizeToContent="WidthAndHeight"
        WindowStartupLocation="CenterScreen"
        Icon="avares://ScimitarBattery/Assets/app-icon.png">
  <StackPanel Margin="24" Spacing="16">
    <TextBlock Text="Scimitar Battery Monitor" FontWeight="Bold" FontSize="18"/>
    <TextBlock Text="Configure device, poll interval, and thresholds." Opacity="0.8" TextWrapping="Wrap"/>
    <TextBlock x:Name="StatusText" Opacity="0.85" Foreground="OrangeRed" TextWrapping="Wrap"/>

    <StackPanel Spacing="8">
      <TextBlock Text="Device" FontWeight="Bold" Foreground="#8FD3FF"/>
      <Grid ColumnDefinitions="*,Auto">
        <ComboBox x:Name="DeviceCombo" HorizontalAlignment="Stretch" Margin="0,0,12,0">
          <ComboBox.ItemTemplate>
            <DataTemplate>
              <TextBlock Text="{Binding Label}"/>
            </DataTemplate>
          </ComboBox.ItemTemplate>
        </ComboBox>
        <Button x:Name="RefreshDevices" Content="Refresh" Grid.Column="1"/>
      </Grid>
    </StackPanel>

    <StackPanel Spacing="8">
      <TextBlock Text="Polling and thresholds" FontWeight="Bold" Foreground="#8FD3FF"/>
      <StackPanel Orientation="Horizontal" Spacing="16">
        <StackPanel Spacing="6" Width="150">
          <TextBlock Text="Poll (sec)"/>
          <NumericUpDown x:Name="PollInterval" Minimum="1" Maximum="3600" Value="30" Increment="5"/>
        </StackPanel>
      </StackPanel>
    </StackPanel>

    <StackPanel Spacing="8">
      <TextBlock Text="Notifications" FontWeight="Bold" Foreground="#8FD3FF"/>
      <StackPanel Spacing="8">
        <StackPanel Spacing="6">
          <TextBlock Text="Route"/>
          <ComboBox x:Name="NotificationRouteCombo" HorizontalAlignment="Stretch"/>
        </StackPanel>

        <TextBlock Text="Battery thresholds and colors" FontWeight="Bold" Foreground="#8FD3FF" Margin="0,4,0,0"/>
        <Grid ColumnDefinitions="Auto,Auto,120,Auto" RowDefinitions="Auto,Auto,Auto,Auto">
          <TextBlock Text=" " Grid.Row="0" />
          <TextBlock Text=" " Grid.Row="0" Grid.Column="1"/>
          <TextBlock Text="Threshold (%)" Grid.Row="0" Grid.Column="2" Opacity="0.8"/>
          <TextBlock Text="Color" Grid.Row="0" Grid.Column="3" Opacity="0.8"/>

          <TextBlock Text="Full battery" Grid.Row="1" VerticalAlignment="Center" Margin="0,0,12,8"/>
          <ColorPicker x:Name="BatteryColorHighPicker" Grid.Row="1" Grid.Column="3" Height="32" MinWidth="140" IsAlphaEnabled="False" Margin="0,0,0,8"/>

          <TextBlock Text="Low battery" Grid.Row="2" VerticalAlignment="Center" Margin="0,0,12,8"/>
          <CheckBox x:Name="NotifyLow" Grid.Row="2" Grid.Column="1" Content="Low" VerticalAlignment="Center" Margin="0,0,12,8"/>
          <NumericUpDown x:Name="LowThreshold" Grid.Row="2" Grid.Column="2" Minimum="0" Maximum="100" Value="30" Width="110" MinWidth="110" Margin="0,0,12,8"/>
          <ColorPicker x:Name="BatteryColorMidPicker" Grid.Row="2" Grid.Column="3" Height="32" MinWidth="140" IsAlphaEnabled="False" Margin="0,0,0,8"/>

          <TextBlock Text="Critical battery" Grid.Row="3" VerticalAlignment="Center" Margin="0,0,12,0"/>
          <CheckBox x:Name="NotifyCritical" Grid.Row="3" Grid.Column="1" Content="Critical" VerticalAlignment="Center" Margin="0,0,12,0"/>
          <NumericUpDown x:Name="CriticalThreshold" Grid.Row="3" Grid.Column="2" Minimum="0" Maximum="100" Value="15" Width="110" MinWidth="110" Margin="0,0,12,0"/>
          <ColorPicker x:Name="BatteryColorLowPicker" Grid.Row="3" Grid.Column="3" Height="32" MinWidth="140" IsAlphaEnabled="False"/>
        </Grid>
      </StackPanel>

      <StackPanel Spacing="6" Margin="0,6,0,0">
        <TextBlock Text="Startup" FontWeight="Bold" Foreground="#8FD3FF"/>
        <CheckBox x:Name="StartWithWindows" Content="Start with Windows (background)"/>
        <TextBlock Text="Runs quietly in the tray. You can open Settings from the tray icon." Opacity="0.7" FontSize="11" TextWrapping="Wrap"/>
      </StackPanel>

      <TextBlock Text="Device LED" FontWeight="Bold" Foreground="#8FD3FF" Margin="0,8,0,0"/>
      <CheckBox x:Name="EnableBatteryLed" Content="Use mouse LED to indicate battery"/>
      <StackPanel Orientation="Horizontal" Spacing="12" Margin="0,4,0,0">
        <StackPanel Spacing="6" Width="180">
          <TextBlock Text="LED target"/>
          <ComboBox x:Name="BatteryLedTargetCombo" HorizontalAlignment="Stretch"/>
        </StackPanel>
        <StackPanel Spacing="6" Width="180">
          <TextBlock Text="Control mode"/>
          <ComboBox x:Name="LightingControlModeCombo" HorizontalAlignment="Stretch"/>
        </StackPanel>
      </StackPanel>

      <TextBlock Text="LEDs to test" FontWeight="Bold" Foreground="#8FD3FF" Margin="0,8,0,0"/>
      <StackPanel Orientation="Horizontal" Spacing="12">
        <ItemsControl x:Name="LedSelectionList">
          <ItemsControl.ItemsPanel>
            <ItemsPanelTemplate>
              <WrapPanel Orientation="Horizontal"/>
            </ItemsPanelTemplate>
          </ItemsControl.ItemsPanel>
          <ItemsControl.ItemTemplate>
            <DataTemplate>
              <StackPanel Orientation="Horizontal" Spacing="8" Margin="0,0,16,8" Width="240">
                <Border Width="12" Height="12" Background="#8FD3FF" CornerRadius="6" VerticalAlignment="Center"/>
                <CheckBox IsChecked="{Binding IsSelected}" IsEnabled="{Binding IsSelectable}" VerticalAlignment="Center"/>
                <TextBlock Text="{Binding Label}" VerticalAlignment="Center"/>
              </StackPanel>
            </DataTemplate>
          </ItemsControl.ItemTemplate>
        </ItemsControl>
        <Button x:Name="TestLedButton" Content="Test LED (High)" VerticalAlignment="Center" Margin="0,0,0,8"/>
      </StackPanel>

      <!-- Colors are now aligned with thresholds above. -->
    </StackPanel>

    <StackPanel Orientation="Horizontal" Spacing="12" Margin="0,8,0,0">
      <Button x:Name="SaveButton" Content="Save" Click="OnSave"/>
      <Button x:Name="TestNotificationsButton" Content="Test notifications" Click="OnTestNotifications"/>
      <Button Content="Close" Click="OnClose"/>
    </StackPanel>
  </StackPanel>
</Window>
